y = "Average Magnitude") +
theme_1c()
plot_width <- ggplot(yearly_summary, aes(x = yr, y = AverageWidth)) +
geom_line(size = 1, color = pal[6]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Width",
x = "Year",
y = "Average Width (yards)") +
theme_1c()
plot_length <- ggplot(yearly_summary, aes(x = yr, y = AverageLength)) +
geom_line(size = 1, color = pal[8]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Length",
x = "Year",
y = "Average Length (miles)") +
theme_1c()
# Arranging the plots in a grid
grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Combine the plots
#combined_plot <- plot_occurrences / plot_mag / plot_width / plot_length
# Arranging the plots in a 2x2 grid
combined_plot <- grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Save the combined plot as a single image
ggsave("combined_plots_2.png", combined_plot, width = 10, height = 15, dpi = 300, bg = "white")
# Save the combined plot as a single image
#ggsave("combined_plots_2.png", combined_plot, width = 10, height = 15, dpi = 300, bg = "white")
data_1b <- data.frame(tornados)
data_1b$mag <- as.numeric(as.character(data_1b$mag))
yearly_count <- data_1b %>%
group_by(yr) %>%
summarise(TotalTornadoes = n())
# Define a function to calculate mode
get_mode <- function(v) {
uniqv <- unique(na.omit(v))
uniqv[which.max(tabulate(match(v, uniqv)))]
}
# Summarizing the data by year
yearly_summary <- data_1b %>%
group_by(yr) %>%
summarise(
AverageMag = mean(mag, na.rm = TRUE),
AverageWidth = median(wid, na.rm = TRUE),
AverageLength = median(len, na.rm = TRUE)
)
special_year <- c(1974, 2011, 2020)
plot_occurrences <- ggplot(yearly_count, aes(x = yr, y = TotalTornadoes)) +
geom_line(size = 1, color = pal[2]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Total Yearly Tornado Occurrences",
x = "Year",
y = "Number of Tornadoes") +
theme_1c()
# Creating three separate plots
plot_mag <- ggplot(yearly_summary, aes(x = yr, y = AverageMag)) +
geom_line(size = 1, color = pal[4]) +
geom_vline(xintercept = special_year, linetype = 2) +
annotate("text", x = 2011, y = 1.2, size = 12, label = "2011 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 1974, y = 0.8, size = 12, label = "1974 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 2020, y = 1.2, size = 12, label = "2020 Easter Tornado Outbreak", angle = 90, vjust = -0.5) +
labs(title = "Annual Changes in Average Tornado Magnitude",
x = "Year",
y = "Average Magnitude") +
theme_1c()
plot_width <- ggplot(yearly_summary, aes(x = yr, y = AverageWidth)) +
geom_line(size = 1, color = pal[6]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Width",
x = "Year",
y = "Average Width (yards)") +
theme_1c()
plot_length <- ggplot(yearly_summary, aes(x = yr, y = AverageLength)) +
geom_line(size = 1, color = pal[8]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Length",
x = "Year",
y = "Average Length (miles)") +
theme_1c()
# Arranging the plots in a grid
grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Combine the plots
#combined_plot <- plot_occurrences / plot_mag / plot_width / plot_length
# Arranging the plots in a 2x2 grid
combined_plot <- grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Save the combined plot as a single image
ggsave("combined_plots_2.png", combined_plot, width = 30, height = 15, dpi = 300, bg = "white")
# Save the combined plot as a single image
#ggsave("combined_plots_2.png", combined_plot, width = 10, height = 15, dpi = 300, bg = "white")
font_add_google("DM Sans", "DM Sans")
showtext_auto()
main_font = "DM Sans"
theme_1b <- function() {
theme_minimal(
base_family = main_font,
base_size = 11,
base_line_size = 11/22,
base_rect_size = 11/22
) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(color = "grey80"),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"),
panel.grid.minor.x = element_blank(),
axis.title.x = element_text(size = 12, hjust = 0.5, face = "bold"),
axis.title.y = element_text(size = 12, hjust = 0.5, face = "bold"),
legend.title = element_text(face = "bold")
)
}
theme_1c <- function() {
theme_minimal(
base_family = main_font,
base_size = 11,
base_line_size = 11/22,
base_rect_size = 11/22
) +
theme(
plot.title = element_text(size = 32, hjust = 0.5),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
axis.title.x = element_text(size = 32, hjust = 0.5),
axis.title.y = element_text(size = 32, hjust = 0.5),
axis.text.x = element_text(size = 16),
axis.text.y = element_text(size = 16)
)
}
data_1b <- data.frame(tornados)
data_1b$mag <- as.numeric(as.character(data_1b$mag))
yearly_count <- data_1b %>%
group_by(yr) %>%
summarise(TotalTornadoes = n())
# Define a function to calculate mode
get_mode <- function(v) {
uniqv <- unique(na.omit(v))
uniqv[which.max(tabulate(match(v, uniqv)))]
}
# Summarizing the data by year
yearly_summary <- data_1b %>%
group_by(yr) %>%
summarise(
AverageMag = mean(mag, na.rm = TRUE),
AverageWidth = median(wid, na.rm = TRUE),
AverageLength = median(len, na.rm = TRUE)
)
special_year <- c(1974, 2011, 2020)
plot_occurrences <- ggplot(yearly_count, aes(x = yr, y = TotalTornadoes)) +
geom_line(size = 1, color = pal[2]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Total Yearly Tornado Occurrences",
x = "Year",
y = "Number of Tornadoes") +
theme_1c()
# Creating three separate plots
plot_mag <- ggplot(yearly_summary, aes(x = yr, y = AverageMag)) +
geom_line(size = 1, color = pal[4]) +
geom_vline(xintercept = special_year, linetype = 2) +
annotate("text", x = 2011, y = 1.2, size = 12, label = "2011 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 1974, y = 0.8, size = 12, label = "1974 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 2020, y = 1.2, size = 12, label = "2020 Easter Tornado Outbreak", angle = 90, vjust = -0.5) +
labs(title = "Annual Changes in Average Tornado Magnitude",
x = "Year",
y = "Average Magnitude") +
theme_1c()
plot_width <- ggplot(yearly_summary, aes(x = yr, y = AverageWidth)) +
geom_line(size = 1, color = pal[6]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Width",
x = "Year",
y = "Average Width (yards)") +
theme_1c()
plot_length <- ggplot(yearly_summary, aes(x = yr, y = AverageLength)) +
geom_line(size = 1, color = pal[8]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Length",
x = "Year",
y = "Average Length (miles)") +
theme_1c()
# Arranging the plots in a grid
grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Combine the plots
#combined_plot <- plot_occurrences / plot_mag / plot_width / plot_length
# Arranging the plots in a 2x2 grid
combined_plot <- grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Save the combined plot as a single image
ggsave("combined_plots_2.png", combined_plot, width = 30, height = 15, dpi = 300, bg = "white")
# Save the combined plot as a single image
#ggsave("combined_plots_2.png", combined_plot, width = 10, height = 15, dpi = 300, bg = "white")
font_add_google("DM Sans", "DM Sans")
showtext_auto()
main_font = "DM Sans"
theme_1b <- function() {
theme_minimal(
base_family = main_font,
base_size = 11,
base_line_size = 11/22,
base_rect_size = 11/22
) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(color = "grey80"),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"),
panel.grid.minor.x = element_blank(),
axis.title.x = element_text(size = 12, hjust = 0.5, face = "bold"),
axis.title.y = element_text(size = 12, hjust = 0.5, face = "bold"),
legend.title = element_text(face = "bold")
)
}
theme_1c <- function() {
theme_minimal(
base_family = main_font,
base_size = 11,
base_line_size = 11/22,
base_rect_size = 11/22
) +
theme(
plot.title = element_text(size = 32, hjust = 0.5),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
axis.title.x = element_text(size = 24, hjust = 0.5),
axis.title.y = element_text(size = 24, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12)
)
}
data_1b <- data.frame(tornados)
data_1b$mag <- as.numeric(as.character(data_1b$mag))
yearly_count <- data_1b %>%
group_by(yr) %>%
summarise(TotalTornadoes = n())
# Define a function to calculate mode
get_mode <- function(v) {
uniqv <- unique(na.omit(v))
uniqv[which.max(tabulate(match(v, uniqv)))]
}
# Summarizing the data by year
yearly_summary <- data_1b %>%
group_by(yr) %>%
summarise(
AverageMag = mean(mag, na.rm = TRUE),
AverageWidth = median(wid, na.rm = TRUE),
AverageLength = median(len, na.rm = TRUE)
)
special_year <- c(1974, 2011, 2020)
plot_occurrences <- ggplot(yearly_count, aes(x = yr, y = TotalTornadoes)) +
geom_line(size = 1, color = pal[2]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Total Yearly Tornado Occurrences",
x = "Year",
y = "Number of Tornadoes") +
theme_1c()
# Creating three separate plots
plot_mag <- ggplot(yearly_summary, aes(x = yr, y = AverageMag)) +
geom_line(size = 1, color = pal[4]) +
geom_vline(xintercept = special_year, linetype = 2) +
annotate("text", x = 2011, y = 1.2, size = 12, label = "2011 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 1974, y = 0.8, size = 12, label = "1974 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 2020, y = 1.2, size = 12, label = "2020 Easter Tornado Outbreak", angle = 90, vjust = -0.5) +
labs(title = "Annual Changes in Average Tornado Magnitude",
x = "Year",
y = "Average Magnitude") +
theme_1c()
plot_width <- ggplot(yearly_summary, aes(x = yr, y = AverageWidth)) +
geom_line(size = 1, color = pal[6]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Width",
x = "Year",
y = "Average Width (yards)") +
theme_1c()
plot_length <- ggplot(yearly_summary, aes(x = yr, y = AverageLength)) +
geom_line(size = 1, color = pal[8]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Length",
x = "Year",
y = "Average Length (miles)") +
theme_1c()
# Arranging the plots in a grid
grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Combine the plots
#combined_plot <- plot_occurrences / plot_mag / plot_width / plot_length
# Arranging the plots in a 2x2 grid
combined_plot <- grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Save the combined plot as a single image
ggsave("combined_plots_2.png", combined_plot, width = 30, height = 15, dpi = 300, bg = "white")
# Save the combined plot as a single image
#ggsave("combined_plots_2.png", combined_plot, width = 10, height = 15, dpi = 300, bg = "white")
data_1b <- data.frame(tornados)
data_1b$mag <- as.numeric(as.character(data_1b$mag))
yearly_count <- data_1b %>%
group_by(yr) %>%
summarise(TotalTornadoes = n())
# Define a function to calculate mode
get_mode <- function(v) {
uniqv <- unique(na.omit(v))
uniqv[which.max(tabulate(match(v, uniqv)))]
}
# Summarizing the data by year
yearly_summary <- data_1b %>%
group_by(yr) %>%
summarise(
AverageMag = mean(mag, na.rm = TRUE),
AverageWidth = median(wid, na.rm = TRUE),
AverageLength = median(len, na.rm = TRUE)
)
special_year <- c(1974, 2011, 2020)
plot_occurrences <- ggplot(yearly_count, aes(x = yr, y = TotalTornadoes)) +
geom_line(size = 1, color = pal[2]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Total Yearly Tornado Occurrences",
x = "Year",
y = "Number of Tornadoes") +
theme_1c()
# Creating three separate plots
plot_mag <- ggplot(yearly_summary, aes(x = yr, y = AverageMag)) +
geom_line(size = 1, color = pal[4]) +
geom_vline(xintercept = special_year, linetype = 2) +
annotate("text", x = 2011, y = 1.2, size = 8, label = "2011 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 1974, y = 0.8, size = 8, label = "1974 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 2020, y = 1.2, size = 8, label = "2020 Easter Tornado Outbreak", angle = 90, vjust = -0.5) +
labs(title = "Annual Changes in Average Tornado Magnitude",
x = "Year",
y = "Average Magnitude") +
theme_1c()
plot_width <- ggplot(yearly_summary, aes(x = yr, y = AverageWidth)) +
geom_line(size = 1, color = pal[6]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Width",
x = "Year",
y = "Average Width (yards)") +
theme_1c()
plot_length <- ggplot(yearly_summary, aes(x = yr, y = AverageLength)) +
geom_line(size = 1, color = pal[8]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Length",
x = "Year",
y = "Average Length (miles)") +
theme_1c()
# Arranging the plots in a grid
grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Combine the plots
#combined_plot <- plot_occurrences / plot_mag / plot_width / plot_length
# Arranging the plots in a 2x2 grid
combined_plot <- grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Save the combined plot as a single image
ggsave("combined_plots_2.png", combined_plot, width = 30, height = 15, dpi = 300, bg = "white")
# Save the combined plot as a single image
#ggsave("combined_plots_2.png", combined_plot, width = 10, height = 15, dpi = 300, bg = "white")
font_add_google("DM Sans", "DM Sans")
showtext_auto()
main_font = "DM Sans"
theme_1b <- function() {
theme_minimal(
base_family = main_font,
base_size = 11,
base_line_size = 11/22,
base_rect_size = 11/22
) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(color = "grey80"),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"),
panel.grid.minor.x = element_blank(),
axis.title.x = element_text(size = 12, hjust = 0.5, face = "bold"),
axis.title.y = element_text(size = 12, hjust = 0.5, face = "bold"),
legend.title = element_text(face = "bold")
)
}
theme_1c <- function() {
theme_minimal(
base_family = main_font,
base_size = 11,
base_line_size = 11/22,
base_rect_size = 11/22
) +
theme(
plot.title = element_text(size = 32, hjust = 0.5),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
axis.title.x = element_text(size = 20, hjust = 0.5),
axis.title.y = element_text(size = 20, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12)
)
}
data_1b <- data.frame(tornados)
data_1b$mag <- as.numeric(as.character(data_1b$mag))
yearly_count <- data_1b %>%
group_by(yr) %>%
summarise(TotalTornadoes = n())
# Define a function to calculate mode
get_mode <- function(v) {
uniqv <- unique(na.omit(v))
uniqv[which.max(tabulate(match(v, uniqv)))]
}
# Summarizing the data by year
yearly_summary <- data_1b %>%
group_by(yr) %>%
summarise(
AverageMag = mean(mag, na.rm = TRUE),
AverageWidth = median(wid, na.rm = TRUE),
AverageLength = median(len, na.rm = TRUE)
)
special_year <- c(1974, 2011, 2020)
plot_occurrences <- ggplot(yearly_count, aes(x = yr, y = TotalTornadoes)) +
geom_line(size = 1, color = pal[2]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Total Yearly Tornado Occurrences",
x = "Year",
y = "Number of Tornadoes") +
theme_1c()
# Creating three separate plots
plot_mag <- ggplot(yearly_summary, aes(x = yr, y = AverageMag)) +
geom_line(size = 1, color = pal[4]) +
geom_vline(xintercept = special_year, linetype = 2) +
annotate("text", x = 2011, y = 1.2, size = 8, label = "2011 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 1974, y = 0.8, size = 8, label = "1974 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 2020, y = 1.2, size = 8, label = "2020 Easter Tornado Outbreak", angle = 90, vjust = -0.5) +
labs(title = "Annual Changes in Average Tornado Magnitude",
x = "Year",
y = "Average Magnitude") +
theme_1c()
plot_width <- ggplot(yearly_summary, aes(x = yr, y = AverageWidth)) +
geom_line(size = 1, color = pal[6]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Width",
x = "Year",
y = "Average Width (yards)") +
theme_1c()
plot_length <- ggplot(yearly_summary, aes(x = yr, y = AverageLength)) +
geom_line(size = 1, color = pal[8]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Changes in Average Tornado Length",
x = "Year",
y = "Average Length (miles)") +
theme_1c()
# Arranging the plots in a grid
grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Combine the plots
#combined_plot <- plot_occurrences / plot_mag / plot_width / plot_length
# Arranging the plots in a 2x2 grid
combined_plot <- grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Save the combined plot as a single image
ggsave("combined_plots_2.png", combined_plot, width = 30, height = 15, dpi = 300, bg = "white")
# Save the combined plot as a single image
#ggsave("combined_plots_2.png", combined_plot, width = 10, height = 15, dpi = 300, bg = "white")
data_1b <- data.frame(tornados)
data_1b$mag <- as.numeric(as.character(data_1b$mag))
yearly_count <- data_1b %>%
group_by(yr) %>%
summarise(TotalTornadoes = n())
# Define a function to calculate mode
get_mode <- function(v) {
uniqv <- unique(na.omit(v))
uniqv[which.max(tabulate(match(v, uniqv)))]
}
# Summarizing the data by year
yearly_summary <- data_1b %>%
group_by(yr) %>%
summarise(
AverageMag = mean(mag, na.rm = TRUE),
AverageWidth = median(wid, na.rm = TRUE),
AverageLength = median(len, na.rm = TRUE)
)
special_year <- c(1974, 2011, 2020)
plot_occurrences <- ggplot(yearly_count, aes(x = yr, y = TotalTornadoes)) +
geom_line(size = 1, color = pal[2]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Total Yearly Tornado Occurrences",
x = "Year",
y = "Number of Tornadoes") +
theme_1c()
# Creating three separate plots
plot_mag <- ggplot(yearly_summary, aes(x = yr, y = AverageMag)) +
geom_line(size = 1, color = pal[4]) +
geom_vline(xintercept = special_year, linetype = 2) +
annotate("text", x = 2011, y = 1.2, size = 8, label = "2011 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 1974, y = 0.8, size = 8, label = "1974 Super Outbreak", angle = 90, vjust = -0.5) +
annotate("text", x = 2020, y = 1.2, size = 8, label = "2020 Easter Tornado Outbreak", angle = 90, vjust = -0.5) +
labs(title = "Annual Average Tornado Magnitude",
x = "Year",
y = "Average Magnitude") +
theme_1c()
plot_width <- ggplot(yearly_summary, aes(x = yr, y = AverageWidth)) +
geom_line(size = 1, color = pal[6]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Median Tornado Width",
x = "Year",
y = "Average Width (yards)") +
theme_1c()
plot_length <- ggplot(yearly_summary, aes(x = yr, y = AverageLength)) +
geom_line(size = 1, color = pal[8]) +
geom_vline(xintercept = special_year, linetype = 2) +
labs(title = "Annual Median Tornado Length",
x = "Year",
y = "Average Length (miles)") +
theme_1c()
# Arranging the plots in a grid
grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Combine the plots
#combined_plot <- plot_occurrences / plot_mag / plot_width / plot_length
# Arranging the plots in a 2x2 grid
combined_plot <- grid.arrange(plot_occurrences, plot_mag, plot_width, plot_length, ncol = 2)
# Save the combined plot as a single image
ggsave("combined_plots_2.png", combined_plot, width = 30, height = 15, dpi = 300, bg = "white")
# Save the combined plot as a single image
#ggsave("combined_plots_2.png", combined_plot, width = 10, height = 15, dpi = 300, bg = "white")
